##--------------------------------------------------------------------
## MySQL Datastore Plugin
##--------------------------------------------------------------------

## MySQL server address.
##
## Value: Port | IP:Port
##
## Examples: 3306, 127.0.0.1:3306, localhost:3306
mysql.server = 127.0.0.1:3306

## MySQL pool size.
##
## Value: Number
mysql.pool = 8

## MySQL username.
##
## Value: String
mysql.username = root

## MySQL password.
##
## Value: String
mysql.password = 123456

## MySQL database.
##
## Value: String
mysql.database = mqtt

## MySQL query timeout
##
## Value: Duration
mysql.query_timeout = 5s

## Variables: %u = username, %c = clientid

## Authentication query.
##
## Note: In case column names differ in your DB - please use aliases,
## e.g. "my_column_name as password".
##
## Value: SQL
##
## Variables:
##  - %u: username
##  - %c: clientid
##  - %C: common name of client TLS cert
##  - %d: subject of client TLS cert
##
mysql.auth_query = select password from mqtt_device where username = '%u' limit 1

## Superuser query.
##
## Value: SQL
##
## Variables:
##  - %u: username
##  - %c: clientid
##  - %C: common name of client TLS cert
##  - %d: subject of client TLS cert
##
mysql.super_query = select is_superuser from mqtt_device where username = '%u' limit 1

## ACL query.
##
## Value: SQL
##
## Variables:
##  - %a: ipaddr
##  - %u: username
##  - %c: clientid
##
## Note: You can add the 'ORDER BY' statement to control the rules match order
mysql.acl_query = select allow, ipaddr, username, clientid, access, topic from mqtt_acl where ipaddr = '%a' or username = '%u' or username = '$all' or clientid = '%c'
